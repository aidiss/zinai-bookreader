{"version":3,"file":"plugins/plugin.url.js","mappings":"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","sources":["webpack://@internetarchive/bookreader/./src/plugins/url/UrlPlugin.js","webpack://@internetarchive/bookreader/./src/plugins/url/plugin.url.js","webpack://@internetarchive/bookreader/./node_modules/core-js/internals/string-trim-forced.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.object.entries.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.object.from-entries.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.match.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.string.trim.js"],"sourcesContent":["export class UrlPlugin {\n  constructor(options = {}) {\n    this.bookReaderOptions = options;\n\n    // the canonical order of elements is important in the path and query string\n    this.urlSchema = [\n      { name: 'page', position: 'path', default: 'n0' },\n      { name: 'mode', position: 'path', default: '2up' },\n      { name: 'search', position: 'path', deprecated_for: 'q' },\n      { name: 'q', position: 'query_param' },\n      { name: 'sort', position: 'query_param' },\n      { name: 'view', position: 'query_param' },\n      { name: 'admin', position: 'query_param' },\n    ];\n\n    this.urlState = {};\n    this.urlMode = this.bookReaderOptions.urlMode || 'hash';\n    this.urlHistoryBasePath = this.bookReaderOptions.urlHistoryBasePath ||  '/';\n    this.urlLocationPollId = null;\n    this.oldLocationHash = null;\n    this.oldUserHash = null;\n  }\n\n  /**\n   * Parse JSON object URL state to string format\n   * Arrange path names in an order that it is positioned on the urlSchema\n   * @param {Object} urlState\n   * @returns {string}\n   */\n  urlStateToUrlString(urlState) {\n    const searchParams = new URLSearchParams();\n    const pathParams = {};\n\n    Object.keys(urlState).forEach(key => {\n      let schema = this.urlSchema.find(schema => schema.name === key);\n      if (schema?.deprecated_for) {\n        schema = this.urlSchema.find(schemaKey => schemaKey.name === schema.deprecated_for);\n      }\n      if (schema?.position == 'path') {\n        pathParams[schema?.name] = urlState[key];\n      } else {\n        searchParams.append(schema?.name || key, urlState[key]);\n      }\n    });\n\n    const strPathParams = this.urlSchema\n      .filter(s => s.position == 'path')\n      .map(schema => pathParams[schema.name] ? `${schema.name}/${pathParams[schema.name]}` : '')\n      .join('/');\n\n    // replace consecutive slashes with a single slash + remove trailing slashes\n    const strStrippedTrailingSlash = `${strPathParams.replace(/\\/+/g, '/').replace(/\\/+$/, '')}`;\n    const concatenatedPath = `${strStrippedTrailingSlash}?${searchParams.toString()}`;\n    return searchParams.toString() ? concatenatedPath : `${strStrippedTrailingSlash}`;\n  }\n\n  /**\n   * Parse string URL and add it in the current urlState\n   * Example:\n   *  /page/n7/mode/2up => {page: 'n7', mode: '2up'}\n   *  /page/n7/mode/2up/search/hello => {page: 'n7', mode: '2up', q: 'hello'}\n   * @param {string} urlString\n   * @returns {object}\n   */\n  urlStringToUrlState(urlString) {\n    const urlState = {};\n\n    // Fetch searchParams from given {str}\n    // Note: whole URL path is needed for URL parsing\n    const urlPath = new URL(urlString, 'http://example.com');\n    const urlSearchParamsObj = Object.fromEntries(urlPath.searchParams.entries());\n    const splitUrlMatches = urlPath.pathname.match(/[^\\\\/]+\\/[^\\\\/]+/g);\n    const urlStrSplitSlashObj = splitUrlMatches ? Object.fromEntries(splitUrlMatches.map(x => x.split('/'))) : {};\n\n    const doesKeyExists = (_object, _key) => {\n      return Object.keys(_object).some(value => value == _key);\n    };\n\n    // Add path objects to urlState\n    this.urlSchema\n      .filter(schema => schema.position == 'path')\n      .forEach(schema => {\n        const hasPropertyKey = doesKeyExists(urlStrSplitSlashObj, schema.name);\n        const hasDeprecatedKey = doesKeyExists(schema, 'deprecated_for') && hasPropertyKey;\n\n        if (hasDeprecatedKey) {\n          urlState[schema.deprecated_for] = urlStrSplitSlashObj[schema.name];\n          return;\n        }\n\n        if (hasPropertyKey) {\n          urlState[schema.name] = urlStrSplitSlashObj[schema.name];\n          return;\n        }\n      });\n\n    // Add searchParams to urlState\n    Object.entries(urlSearchParamsObj).forEach(([key, value]) => {\n      urlState[key] = value;\n    });\n\n    return urlState;\n  }\n\n  /**\n   * Add or update key-value to the urlState\n   * @param {string} key\n   * @param {string} val\n   */\n  setUrlParam(key, value) {\n    this.urlState[key] = value;\n\n    this.pushToAddressBar();\n  }\n\n  /**\n   * Delete key-value to the urlState\n   * @param {string} key\n   */\n  removeUrlParam(key) {\n    delete this.urlState[key];\n\n    this.pushToAddressBar();\n  }\n\n  /**\n   * Get key-value from the urlState\n   * @param {string} key\n   * @return {string}\n   */\n  getUrlParam(key) {\n    return this.urlState[key];\n  }\n\n  /**\n   * Push URL params to addressbar\n   */\n  pushToAddressBar() {\n    const urlStrPath = this.urlStateToUrlString(this.urlState);\n    const concatenatedPath = urlStrPath !== '/' ? urlStrPath : '';\n    if (this.urlMode == 'history') {\n      if (window.history && window.history.replaceState) {\n        const newUrlPath = `${this.urlHistoryBasePath}${concatenatedPath}`.trim().replace(/(\\/+)/g, '/');\n        window.history.replaceState({}, null, newUrlPath);\n      }\n    } else {\n      window.location.replace('#' + concatenatedPath);\n    }\n    this.oldLocationHash = urlStrPath;\n  }\n\n  /**\n   * Get the url and check if it has changed\n   * If it was changeed, update the urlState\n   */\n  listenForHashChanges() {\n    this.oldLocationHash = window.location.hash.substr(1);\n    if (this.urlLocationPollId) {\n      clearInterval(this.urlLocationPollId);\n      this.urlLocationPollId = null;\n    }\n\n    // check if the URL changes\n    const updateHash = () => {\n      const newFragment = window.location.hash.substr(1);\n      const hasFragmentChange = newFragment != this.oldLocationHash;\n\n      if (!hasFragmentChange) { return; }\n\n      this.urlState = this.urlStringToUrlState(newFragment);\n    };\n    this.urlLocationPollId = setInterval(updateHash, 500);\n  }\n\n  /**\n   * Will read either the hash or URL and return the bookreader fragment\n   */\n  pullFromAddressBar (location = window.location) {\n    const path = this.urlMode === 'history'\n      ? (location.pathname.substr(this.urlHistoryBasePath.length) + location.search)\n      : location.hash.substr(1);\n    this.urlState = this.urlStringToUrlState(path);\n  }\n}\n","/* global BookReader */\n\nimport { UrlPlugin } from \"./UrlPlugin\";\n\n/**\n * Plugin for URL management in BookReader\n * Note read more about the url \"fragment\" here:\n * https://openlibrary.org/dev/docs/bookurls\n */\n\njQuery.extend(BookReader.defaultOptions, {\n  enableUrlPlugin: true,\n  bookId: '',\n  /** @type {string} Defaults can be a urlFragment string */\n  defaults: null,\n  updateWindowTitle: false,\n\n  /** @type {'history' | 'hash'} */\n  urlMode: 'hash',\n\n  /**\n   * When using 'history' mode, this part of the URL is kept constant\n   * @example /details/plato/\n   */\n  urlHistoryBasePath: '/',\n\n  /** Only these params will be reflected onto the URL */\n  urlTrackedParams: ['page', 'search', 'mode', 'region', 'highlight', 'view'],\n\n  /** If true, don't update the URL when `page == n0 (eg \"/page/n0\")` */\n  urlTrackIndex0: false,\n});\n\n/** @override */\nBookReader.prototype.setup = (function(super_) {\n  return function(options) {\n    super_.call(this, options);\n\n    this.bookId = options.bookId;\n    this.defaults = options.defaults;\n\n    this.locationPollId = null;\n    this.oldLocationHash = null;\n    this.oldUserHash = null;\n  };\n})(BookReader.prototype.setup);\n\n/** @override */\nBookReader.prototype.init = (function(super_) {\n  return function() {\n\n    if (this.options.enableUrlPlugin) {\n      this.bind(BookReader.eventNames.PostInit, () => {\n        const { updateWindowTitle, urlMode } = this.options;\n        if (updateWindowTitle) {\n          document.title = this.shortTitle(this.bookTitle, 50);\n        }\n        if (urlMode === 'hash') {\n          this.urlStartLocationPolling();\n        }\n      });\n\n      this.bind(BookReader.eventNames.fragmentChange,\n        this.urlUpdateFragment.bind(this)\n      );\n    }\n    super_.call(this);\n  };\n})(BookReader.prototype.init);\n\n/**\n * Returns a shortened version of the title with the maximum number of characters\n * @param {number} maximumCharacters\n * @return {string}\n */\nBookReader.prototype.shortTitle = function(maximumCharacters) {\n  if (this.bookTitle.length < maximumCharacters) {\n    return this.bookTitle;\n  }\n\n  const title = `${this.bookTitle.substr(0, maximumCharacters - 3)}...`;\n  return title;\n};\n\n/**\n * Starts polling of window.location to see hash fragment changes\n */\nBookReader.prototype.urlStartLocationPolling = function() {\n  this.oldLocationHash = this.urlReadFragment();\n\n  if (this.locationPollId) {\n    clearInterval(this.locationPollId);\n    this.locationPollId = null;\n  }\n\n  const updateHash = () => {\n    const newFragment = this.urlReadFragment();\n    const hasFragmentChange = (newFragment != this.oldLocationHash) && (newFragment != this.oldUserHash);\n\n    if (!hasFragmentChange) { return; }\n\n    const params = this.paramsFromFragment(newFragment);\n\n    const updateParams = () => this.updateFromParams(params);\n\n    this.trigger(BookReader.eventNames.stop);\n    if (this.animating) {\n      // Queue change if animating\n      if (this.autoStop) this.autoStop();\n      this.animationFinishedCallback = updateParams;\n    } else {\n      // update immediately\n      updateParams();\n    }\n    this.oldUserHash = newFragment;\n  };\n\n  this.locationPollId = setInterval(updateHash, 500);\n};\n\n/**\n * Update URL from the current parameters.\n * Call this instead of manually using window.location.replace\n */\nBookReader.prototype.urlUpdateFragment = function() {\n  const allParams = this.paramsFromCurrent();\n  const { urlMode, urlTrackIndex0, urlTrackedParams } = this.options;\n\n  if (!urlTrackIndex0\n      && (typeof(allParams.index) !== 'undefined')\n      && allParams.index === 0) {\n    delete allParams.index;\n    delete allParams.page;\n  }\n\n  const params = urlTrackedParams.reduce((validParams, paramName) => {\n    if (paramName in allParams) {\n      validParams[paramName] = allParams[paramName];\n    }\n    return validParams;\n  }, {});\n\n  const newFragment = this.fragmentFromParams(params, urlMode);\n  const currFragment = this.urlReadFragment();\n  const currQueryString = this.getLocationSearch();\n  const newQueryString = this.queryStringFromParams(params, currQueryString, urlMode);\n  if (currFragment === newFragment && currQueryString === newQueryString) {\n    return;\n  }\n\n  if (urlMode === 'history') {\n    if (window.history && window.history.replaceState) {\n      const baseWithoutSlash = this.options.urlHistoryBasePath.replace(/\\/+$/, '');\n      const newFragmentWithSlash = newFragment === '' ? '' : `/${newFragment}`;\n\n      const newUrlPath = `${baseWithoutSlash}${newFragmentWithSlash}${newQueryString}`;\n      window.history.replaceState({}, null, newUrlPath);\n      this.oldLocationHash = newFragment + newQueryString;\n\n    }\n  } else {\n    const newQueryStringSearch = this.urlParamsFiltersOnlySearch(this.readQueryString());\n    window.location.replace('#' + newFragment + newQueryStringSearch);\n    this.oldLocationHash = newFragment + newQueryStringSearch;\n\n  }\n};\n\n/**\n * @private\n * Filtering query parameters to select only book search param (?q=foo)\n   This needs to be updated/URL system modified if future query params are to be added\n * @param {string} url\n * @return {string}\n * */\nBookReader.prototype.urlParamsFiltersOnlySearch = function(url) {\n  const params = new URLSearchParams(url);\n  return params.has('q') ? `?${new URLSearchParams({ q: params.get('q') })}` : '';\n};\n\n\n/**\n * Will read either the hash or URL and return the bookreader fragment\n * @return {string}\n */\nBookReader.prototype.urlReadFragment = function() {\n  const { urlMode, urlHistoryBasePath } = this.options;\n  if (urlMode === 'history') {\n    return window.location.pathname.substr(urlHistoryBasePath.length);\n  } else {\n    return window.location.hash.substr(1);\n  }\n};\n\n/**\n * Will read the hash return the bookreader fragment\n * @return {string}\n */\nBookReader.prototype.urlReadHashFragment = function() {\n  return window.location.hash.substr(1);\n};\nexport class BookreaderUrlPlugin extends BookReader {\n  init() {\n    if (this.options.enableUrlPlugin) {\n      this.urlPlugin = new UrlPlugin(this.options);\n      this.bind(BookReader.eventNames.PostInit, () => {\n        const { urlMode } = this.options;\n\n        if (urlMode === 'hash') {\n          this.urlPlugin.listenForHashChanges();\n        }\n      });\n    }\n\n    super.init();\n  }\n}\n\nwindow.BookReader = BookreaderUrlPlugin;\nexport default BookreaderUrlPlugin;\n","var fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]() || non[METHOD_NAME]() != non || whitespaces[METHOD_NAME].name !== METHOD_NAME;\n  });\n};\n","var $ = require('../internals/export');\nvar $entries = require('../internals/object-to-array').entries;\n\n// `Object.entries` method\n// https://tc39.es/ecma262/#sec-object.entries\n$({ target: 'Object', stat: true }, {\n  entries: function entries(O) {\n    return $entries(O);\n  }\n});\n","var $ = require('../internals/export');\nvar iterate = require('../internals/iterate');\nvar createProperty = require('../internals/create-property');\n\n// `Object.fromEntries` method\n// https://github.com/tc39/proposal-object-from-entries\n$({ target: 'Object', stat: true }, {\n  fromEntries: function fromEntries(iterable) {\n    var obj = {};\n    iterate(iterable, function (k, v) {\n      createProperty(obj, k, v);\n    }, { AS_ENTRIES: true });\n    return obj;\n  }\n});\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@match logic\nfixRegExpWellKnownSymbolLogic('match', function (MATCH, nativeMatch, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.es/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = requireObjectCoercible(this);\n      var matcher = regexp == undefined ? undefined : regexp[MATCH];\n      return matcher !== undefined ? matcher.call(regexp, O) : new RegExp(regexp)[MATCH](toString(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@match\n    function (string) {\n      var rx = anObject(this);\n      var S = toString(string);\n      var res = maybeCallNative(nativeMatch, rx, S);\n\n      if (res.done) return res.value;\n\n      if (!rx.global) return regExpExec(rx, S);\n\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = toString(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.es/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n"],"names":["UrlPlugin","options","bookReaderOptions","urlSchema","name","position","default","deprecated_for","urlState","urlMode","urlHistoryBasePath","urlLocationPollId","oldLocationHash","oldUserHash","searchParams","URLSearchParams","pathParams","Object","keys","forEach","key","schema","find","schemaKey","append","strPathParams","filter","s","map","join","strStrippedTrailingSlash","replace","concatenatedPath","toString","urlString","urlPath","URL","urlSearchParamsObj","fromEntries","entries","splitUrlMatches","pathname","match","urlStrSplitSlashObj","x","split","doesKeyExists","_object","_key","some","value","hasPropertyKey","hasDeprecatedKey","pushToAddressBar","urlStrPath","urlStateToUrlString","window","history","replaceState","newUrlPath","trim","location","hash","substr","clearInterval","updateHash","newFragment","hasFragmentChange","urlStringToUrlState","setInterval","path","length","search","jQuery","extend","BookReader","defaultOptions","enableUrlPlugin","bookId","defaults","updateWindowTitle","urlTrackedParams","urlTrackIndex0","prototype","setup","super_","call","locationPollId","init","bind","eventNames","PostInit","document","title","shortTitle","bookTitle","urlStartLocationPolling","fragmentChange","urlUpdateFragment","maximumCharacters","urlReadFragment","params","paramsFromFragment","updateParams","updateFromParams","trigger","stop","animating","autoStop","animationFinishedCallback","allParams","paramsFromCurrent","index","page","reduce","validParams","paramName","fragmentFromParams","currFragment","currQueryString","getLocationSearch","newQueryString","queryStringFromParams","baseWithoutSlash","newFragmentWithSlash","newQueryStringSearch","urlParamsFiltersOnlySearch","readQueryString","url","has","q","get","urlReadHashFragment","BookreaderUrlPlugin","urlPlugin","listenForHashChanges"],"sourceRoot":""}